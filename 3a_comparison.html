
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discontinuous Galerkin for the advection equation &#8212; A Study of advection schemes</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.jpg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">A Study of advection schemes</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="reference internal" href="#">
   Discontinuous Galerkin for the advection equation
  </a>
 </li>
</ul>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/3a_comparison.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/mwiesenberger/advection"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/mwiesenberger/advection/issues/new?title=Issue%20on%20page%20%2F3a_comparison.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/mwiesenberger/advection/master?urlpath=tree/docs/3a_comparison.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   Motivation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-simple-test-scenario">
   A simple test scenario
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#initial-condition">
   Initial condition
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-naive-approach">
   A naive approach
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#arakawa">
   Arakawa
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#upwind-scheme">
   Upwind scheme
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#correct-multiplication-of-dg-polynomials">
   Correct multiplication of dG polynomials
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modal-filtering">
   Modal filtering
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#viscosity-and-hyperviscosity">
   Viscosity and hyperviscosity
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="discontinuous-galerkin-for-the-advection-equation">
<h1>Discontinuous Galerkin for the advection equation<a class="headerlink" href="#discontinuous-galerkin-for-the-advection-equation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h2>
<p>The motivation for this study stems from the observation that our 3d turbulence simulations in Feltor seem to</p>
<ul class="simple">
<li><p>require a significant higher resolution  and</p></li>
<li><p>seem to generate significantly smaller scales</p></li>
</ul>
<p>than finite Difference simulations of the same region like Grillix or Tokam3X.
Since our simulations operate at the limit of our available HPC resources simply increasing the resolution further is not an option. This results in the situation where Feltor cannot simulate the same regions of the tokamak that other frameworks seem to be able to.</p>
<p>Currently, there are two hypotheses</p>
<ul class="simple">
<li><p>the gyro-fluid model in use physically produces smaller scales than the drift-fluid models</p></li>
<li><p>the required high resolution is a fundamental problem of the discontinuous Galerkin discretization</p></li>
</ul>
<p>In this report we want to test the second hypothesis in more detail. In order to do this we consider a simple test scenario as a testbed for a variety of dG and FD discretization and filter techniques.</p>
</div>
<div class="section" id="a-simple-test-scenario">
<h2>A simple test scenario<a class="headerlink" href="#a-simple-test-scenario" title="Permalink to this headline">¶</a></h2>
<p>We consider the 2d incompressible Euler equations</p>
<div class="amsmath math notranslate nohighlight" id="equation-957d276d-1ea1-4690-9fbf-a2f95d3b3101">
<span class="eqno">(1)<a class="headerlink" href="#equation-957d276d-1ea1-4690-9fbf-a2f95d3b3101" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \frac{\partial \omega}{\partial t} + \nabla\cdot({\vec v \omega}) = 0 \nonumber\\
\omega = - \Delta\phi \quad v_x = - \phi_y \quad v_y = \phi_x
\end{align}\]</div>
<p>with vorticity <span class="math notranslate nohighlight">\(\omega\)</span> and stream-function <span class="math notranslate nohighlight">\(\phi\)</span>. The Euler equations have an infinite amount of conserved quantities
among them the total vorticity <span class="math notranslate nohighlight">\(V\)</span>, the kinetic energy <span class="math notranslate nohighlight">\(E\)</span> and the enstrophy <span class="math notranslate nohighlight">\(\Omega\)</span></p>
<div class="amsmath math notranslate nohighlight" id="equation-f1c9a4db-24ab-4be1-ab1c-ee00e6907803">
<span class="eqno">(2)<a class="headerlink" href="#equation-f1c9a4db-24ab-4be1-ab1c-ee00e6907803" title="Permalink to this equation">¶</a></span>\[\begin{align}
     V := \int_D \omega \mathrm{d}A\quad
     E :=\frac{1}{2} \int_D \left( \nabla \phi\right)^2 \mathrm{d}A \quad
     \Omega_n:= \frac{1}{2} \int_D \omega^{2n }\mathrm{d}A
 \end{align}\]</div>
<p>Often, these invariants are taken as a measure of quality of the integrator.</p>
</div>
<div class="section" id="initial-condition">
<h2>Initial condition<a class="headerlink" href="#initial-condition" title="Permalink to this headline">¶</a></h2>
<p>We consider the double shear layer problem</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="_images/3a_comparison_9_0.png" src="_images/3a_comparison_9_0.png" />
</div>
</div>
<p>We will then integrate the solution from <span class="math notranslate nohighlight">\(t=0\)</span> to <span class="math notranslate nohighlight">\(t=10\)</span> using various methods. The expected result is</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="_images/3a_comparison_11_0.png" src="_images/3a_comparison_11_0.png" />
</div>
</div>
</div>
<div class="section" id="a-naive-approach">
<h2>A naive approach<a class="headerlink" href="#a-naive-approach" title="Permalink to this headline">¶</a></h2>
<p>The first approach to discretize is to simply use centered differences (or the dG analogue) for the flux</p>
<div class="amsmath math notranslate nohighlight" id="equation-b9606ffc-61aa-46aa-b1ed-7bc1eee0a868">
<span class="eqno">(3)<a class="headerlink" href="#equation-b9606ffc-61aa-46aa-b1ed-7bc1eee0a868" title="Permalink to this equation">¶</a></span>\[\begin{align} 
\frac{\partial}{\partial x} f \rightarrow \frac{f_{i+1}-f_{i-1}}{2h_x}
\end{align}\]</div>
<p>It is well known that the forward in time, centered in space method for solving
hyperbolic systems is <strong>unconditionally unstable</strong> <a class="bibtex reference internal" href="#leveque" id="id1">[LeV02]</a>.
Reference <a class="bibtex reference internal" href="#liu2000" id="id2">[LS00]</a> reports that the centered flux does not have any numerical
diffusion while the upwind flux does.
They also prove that upwind and centered fluxes do not dissipate energy.</p>
<p id="bibtex-bibliography-3a_comparison-0"><dl class="citation">
<dt class="bibtex label" id="einkemmer2014"><span class="brackets"><a class="fn-backref" href="#id3">EW14</a></span></dt>
<dd><p>L. Einkemmer and M. Wiesenberger. A conservative discontinuous galerkin scheme for the 2d incompressible navier–stokes equations. <em>Comput. Phys. Commun.</em>, 185(11):2865–2873, 2014. <a class="reference external" href="https://doi.org/10.1016/j.cpc.2014.07.007">doi:10.1016/j.cpc.2014.07.007</a>.</p>
</dd>
<dt class="bibtex label" id="nodaldg"><span class="brackets">HW08</span><span class="fn-backref">(<a href="#id4">1</a>,<a href="#id5">2</a>,<a href="#id6">3</a>)</span></dt>
<dd><p>J.S. Hesthaven and T. Warburton. <em>Nodal discontinuous Galerkin methods: algorithms, analysis, and applications</em>. Texts in Applied Mathematics. Springer Media, 2008.</p>
</dd>
<dt class="bibtex label" id="leveque"><span class="brackets"><a class="fn-backref" href="#id1">LeV02</a></span></dt>
<dd><p>R.J. LeVeque. <em>Finite Volume Methods for Hyperbolic Problems</em>. Cambridge Texts in Applied Mathematics. Cambridge University Press, 2002.</p>
</dd>
<dt class="bibtex label" id="liu2000"><span class="brackets"><a class="fn-backref" href="#id2">LS00</a></span></dt>
<dd><p>J.G. Liu and C.W. Shu. A high-order discontinuous galerkin method for 2d incompressible flows. <em>J. Comput. Phys.</em>, 160:557–596, 2000. <a class="reference external" href="https://doi.org/10.1006/jcph.2000.6475">doi:10.1006/jcph.2000.6475</a>.</p>
</dd>
</dl>
</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="_images/3a_comparison_13_0.png" src="_images/3a_comparison_13_0.png" />
<img alt="_images/3a_comparison_13_1.png" src="_images/3a_comparison_13_1.png" />
</div>
</div>
<p>We observe that</p>
<ul class="simple">
<li><p>both the FD and the dG scheme of order 5 produce a lot of oscillations</p></li>
<li><p>even though the number of spatial points is the same (~140) the dG scheme has to use a 5 times smaller time step</p></li>
</ul>
</div>
<div class="section" id="arakawa">
<h2>Arakawa<a class="headerlink" href="#arakawa" title="Permalink to this headline">¶</a></h2>
<p>The Arakawa scheme was generalized for dG methods in <a class="bibtex reference internal" href="#einkemmer2014" id="id3">[EW14]</a> and is a method that conserves vorticity, energy and enstrophy exactly. Just as for the centered differences it is well-known that the scheme produces oscillations without a diffusive term.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="_images/3a_comparison_15_0.png" src="_images/3a_comparison_15_0.png" />
<img alt="_images/3a_comparison_15_1.png" src="_images/3a_comparison_15_1.png" />
</div>
</div>
<ul class="simple">
<li><p>The Arakawa scheme without regularization is indeed always unstable (also for projection method described later)</p></li>
<li><p>Note that the higher order simulation takes 5-6 times longer to complete</p></li>
</ul>
</div>
<div class="section" id="upwind-scheme">
<h2>Upwind scheme<a class="headerlink" href="#upwind-scheme" title="Permalink to this headline">¶</a></h2>
<p>The idea of an upwind scheme is to use either a forward or a backward discretization of the flux <span class="math notranslate nohighlight">\(f=\omega v\)</span> depending on the sign of the velocity</p>
<div class="amsmath math notranslate nohighlight" id="equation-92e51c9b-811f-4ccb-9b62-0c9744dec3b0">
<span class="eqno">(4)<a class="headerlink" href="#equation-92e51c9b-811f-4ccb-9b62-0c9744dec3b0" title="Permalink to this equation">¶</a></span>\[\begin{align}
\frac{\partial}{\partial x} f \rightarrow \begin{cases}
    \frac{f_{i+1}-f_i}{h} \text{ if } v &lt; 0 \\
    \frac{f_{i} - f_{i-1}}{h} \text{  if } v &gt; 0
    \end{cases}
\end{align}\]</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="_images/3a_comparison_17_0.png" src="_images/3a_comparison_17_0.png" />
<img alt="_images/3a_comparison_17_1.png" src="_images/3a_comparison_17_1.png" />
<img alt="_images/3a_comparison_17_2.png" src="_images/3a_comparison_17_2.png" />
</div>
</div>
<ul class="simple">
<li><p>The upwind scheme of first order introduces a lot of numerical diffusion,</p></li>
<li><p>the higher order dG schemes with pointwise multiplication seem to be unstable at stagnation points</p></li>
</ul>
</div>
<div class="section" id="correct-multiplication-of-dg-polynomials">
<h2>Correct multiplication of dG polynomials<a class="headerlink" href="#correct-multiplication-of-dg-polynomials" title="Permalink to this headline">¶</a></h2>
<p>In the computation of the flux <span class="math notranslate nohighlight">\(n v\)</span> the approach that we used above (termed <strong>pointwise</strong>) was to simply compute the pointwise multiplication of the nodal discretization <a class="bibtex reference internal" href="#nodaldg" id="id4">[HW08]</a>. However, the correct approach when multiplying
two dG discretized functions is to interpolate both onto a  higher degree polynomial (of degree <span class="math notranslate nohighlight">\(2n\)</span>) and then projecting the result back unto the lower degree polynomial <span class="math notranslate nohighlight">\(n\)</span>). We call this the <strong>projection</strong> method <a class="bibtex reference internal" href="#nodaldg" id="id5">[HW08]</a>.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="_images/3a_comparison_19_0.png" src="_images/3a_comparison_19_0.png" />
<img alt="_images/3a_comparison_19_1.png" src="_images/3a_comparison_19_1.png" />
</div>
</div>
<ul class="simple">
<li><p>Only the upwind scheme with correct multiplication and projection of polynomials seems to work reliably without regularization. Only small oscillations are visible.</p></li>
<li><p>The higher order scheme seems to allow smaller scales than the 3rd order scheme</p></li>
</ul>
</div>
<div class="section" id="modal-filtering">
<h2>Modal filtering<a class="headerlink" href="#modal-filtering" title="Permalink to this headline">¶</a></h2>
<p>In <a class="bibtex reference internal" href="#nodaldg" id="id6">[HW08]</a> an alternative to the projection method was suggested to stabilize dG methods. The modal filter can be thought of as a de-aliasing technique for dG methods and is thought to be an alternative to artificial diffusion techniques.
The technique consists in applying the filter <span class="math notranslate nohighlight">\(f(\eta)\)</span> to each mode <span class="math notranslate nohighlight">\(\eta\)</span> after every timestep</p>
<div class="amsmath math notranslate nohighlight" id="equation-ca09abc0-666d-48d1-bd8d-ff648a8511a0">
<span class="eqno">(5)<a class="headerlink" href="#equation-ca09abc0-666d-48d1-bd8d-ff648a8511a0" title="Permalink to this equation">¶</a></span>\[\begin{align}
\omega_\eta^{n+1} = f(\eta) \omega_\eta^n
\end{align}\]</div>
<p>We experiment with the exponential filter shown in the next graph</p>
<p><img alt="Filter function" src="_images/filter.png" /></p>
<p>First, let us try to apply the filter to the upwind scheme with pointwise multiplication (as was originally suggested)</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="_images/3a_comparison_22_0.png" src="_images/3a_comparison_22_0.png" />
<img alt="_images/3a_comparison_22_1.png" src="_images/3a_comparison_22_1.png" />
</div>
</div>
<ul class="simple">
<li><p>The modal Filter introduces numerical diffusion but seems to have (slight) troubles at the stagnation points</p></li>
<li><p>also true for the projection method</p></li>
<li><p>in a way the modal filter is a projection filter (projecting out high frequencies) and should thus be equivalent to a projection method of lower order and the same number of cells</p></li>
</ul>
<p>Let us now try to apply the modal filter on the Arakawa scheme</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="_images/3a_comparison_24_0.png" src="_images/3a_comparison_24_0.png" />
<img alt="_images/3a_comparison_24_1.png" src="_images/3a_comparison_24_1.png" />
<img alt="_images/3a_comparison_24_2.png" src="_images/3a_comparison_24_2.png" />
</div>
</div>
<ul class="simple">
<li><p>The modal filter with <span class="math notranslate nohighlight">\(\eta_c=0.5\)</span>, <span class="math notranslate nohighlight">\(s=8\)</span> and <span class="math notranslate nohighlight">\(\alpha=36\)</span> improves the oscillations in the Arakawa scheme but does not entirely remove them</p></li>
<li><p>The modal filter with <span class="math notranslate nohighlight">\(\eta_c=0.0\)</span>, <span class="math notranslate nohighlight">\(s=8\)</span> and <span class="math notranslate nohighlight">\(\alpha=36\)</span> further dampens the oscillations but overdampens the vortex structure while still having trouble at the symmetry points</p></li>
<li><p>This situation is the same for the projection and the centered methods</p></li>
</ul>
<p><strong>The modal filter is unable to make the unstable techniques stable and is somewhat similar to a projection method of lower order</strong> -&gt; maybe look more into equivalence of projection and modal filtering? Especially for order 3 this seems evident</p>
</div>
<div class="section" id="viscosity-and-hyperviscosity">
<h2>Viscosity and hyperviscosity<a class="headerlink" href="#viscosity-and-hyperviscosity" title="Permalink to this headline">¶</a></h2>
<p>In order to make the centered and Arakawa discretization stable, usually artificial viscosity is added to the equations to discretize</p>
<div class="amsmath math notranslate nohighlight" id="equation-ea822a74-e26d-40b1-bef0-ef16d55b5984">
<span class="eqno">(6)<a class="headerlink" href="#equation-ea822a74-e26d-40b1-bef0-ef16d55b5984" title="Permalink to this equation">¶</a></span>\[\begin{align}
 \frac{\partial}{\partial t} + \nabla \cdot ( \omega \vec v) = - (-\nu \Delta)^s \omega
 \end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(s=1,2,...\)</span> is the order. This technique clearly destroys the exact energy
and enstrophy conservation of the original system.
Since Fourier modes are Eigenfunctions of the Laplace operator the artificial viscosity can be seen as a low pass filters of order <span class="math notranslate nohighlight">\(s\)</span> for spectral schemes. In contrast to a modal dG filter however, the spectral filter applies to the entire box as a whole and not just to individual cells.
We now want to show that</p>
<ul class="simple">
<li><p>the schemes that produce less oscillations also need less viscosity</p></li>
<li><p>in particular the order 1 arakawa scheme needs less viscosity than higher order dG schemes (because higher order polynomials produce more oscillations)</p></li>
</ul>
<p>We will now use the semi-implicit Karniadakis scheme.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Matthias Wiesenberger<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>